{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\src\\views\\vadmin\\system\\savefile\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\src\\views\\vadmin\\system\\savefile\\index.vue","mtime":1620833396858},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7Y2xlYXJTYXZlRmlsZSwgZGVsU2F2ZUZpbGUsIGxpc3RTYXZlRmlsZX0gZnJvbSAiQC9hcGkvdmFkbWluL3N5c3RlbS9zYXZlZmlsZSI7CmltcG9ydCBGaWxlVXBsb2FkIGZyb20gIkAvY29tcG9uZW50cy9GaWxlVXBsb2FkL2luZGV4IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU2F2ZWZpbGUiLAogIGNvbXBvbmVudHM6IHtGaWxlVXBsb2FkfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOaYvuekuuaQnOe0ouadoeS7tgogICAgICBzaG93U2VhcmNoOiB0cnVlLAogICAgICAvLyDpnZ7ljZXkuKrnpoHnlKgKICAgICAgc2luZ2xlOiB0cnVlLAogICAgICAvLyDpnZ7lpJrkuKrnpoHnlKgKICAgICAgbXVsdGlwbGU6IHRydWUsCiAgICAgIC8vIOW8ueWHuuWxguagh+mimAogICAgICB0aXRsZTogIiIsCiAgICAgIC8vIOaYr+WQpuaYvuekuuW8ueWHuuWxggogICAgICBvcGVuOiBmYWxzZSwKICAgICAgLy8g5p+l6K+i5Y+C5pWwCiAgICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgICAgcGFnZU51bTogMSwKICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgbmFtZTogdW5kZWZpbmVkLAogICAgICAgIHR5cGU6IHVuZGVmaW5lZCwKICAgICAgfSwKICAgICAgLy8g5oC75p2h5pWwCiAgICAgIHRvdGFsOiAwLAogICAgICAvLyDmlbDmja7liJfooagKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0TGlzdCgpOwogIH0sCiAgbW91bnRlZCgpIHsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKiDmn6Xor6LliJfooaggKi8KICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGxpc3RTYXZlRmlsZSh0aGlzLnF1ZXJ5UGFyYW1zKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmZpbGVMaXN0ID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRzOwogICAgICAgIHRoaXMudG90YWwgPSByZXNwb25zZS5kYXRhLmNvdW50OwogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICB9KTsKICAgIH0sCiAgICAvKiog5pCc57Si5oyJ6ZKu5pON5L2cICovCiAgICBoYW5kbGVRdWVyeSgpIHsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICB9LAogICAgLyoqIOmHjee9ruaMiemSruaTjeS9nCAqLwogICAgcmVzZXRRdWVyeSgpIHsKICAgICAgdGhpcy5yZXNldEZvcm0oInF1ZXJ5Rm9ybSIpOwogICAgICB0aGlzLmhhbmRsZVF1ZXJ5KCk7CiAgICB9LAogICAgLyoqIOS4iuS8oOaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlQWRkKHJvdykgewogICAgICB0aGlzLm9wZW4gPSB0cnVlOwogICAgICB0aGlzLnRpdGxlID0gIuS4iuS8oOaWh+S7tiI7CiAgICB9LAogICAgLyoqIOaWh+S7tuS4i+i9vSAqKi8KICAgIGhhbmRsZURvd25sb2FkKHJvdykgewogICAgICB0aGlzLmRvd25sb2FkKHJvdy5maWxlX3VybCwgcm93Lm5hbWUpCiAgICB9LAogICAgLyoqIOWIoOmZpOaMiemSruaTjeS9nCAqLwogICAgaGFuZGxlRGVsZXRlKHJvdykgewogICAgICBjb25zdCB1c2VySWRzID0gcm93LmlkIHx8IHRoaXMuaWRzOwogICAgICB0aGlzLiRjb25maXJtKCfmmK/lkKbnoa7orqTliKDpmaTmlofku7bnvJblj7fkuLoiJyArIHVzZXJJZHMgKyAnIueahOaVsOaNrumhuT8nLCAi6K2m5ZGKIiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGRlbFNhdmVGaWxlKHVzZXJJZHMpOwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLmdldExpc3QoKTsKICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwogICAgICB9KQogICAgfSwKICAgIC8vIOWkmumAieahhumAieS4reaVsOaNrgogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHNlbGVjdGlvbikgewogICAgICB0aGlzLmlkcyA9IHNlbGVjdGlvbi5tYXAoaXRlbSA9PiBpdGVtLmlkKQogICAgICB0aGlzLnNpbmdsZSA9IHNlbGVjdGlvbi5sZW5ndGggIT09IDEKICAgICAgdGhpcy5tdWx0aXBsZSA9ICFzZWxlY3Rpb24ubGVuZ3RoCiAgICB9LAogICAgLyoqIOa4heeQhuW6n+W8g+aWh+S7tiAqLwogICAgaGFuZGxlQ2xlYXIoKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+atpOmhueaTjeS9nOS8muaKiuaJgOacieaVsOaNruW6k+S4reS4jeWtmOWcqOeahOaWh+S7tuWIoOmZpO+8jOWMheaLrE9TU+S4reeahOaWh+S7tu+8jOaYr+WQpuehruiupOimgea4heeQhuW6n+W8g+aWh+S7tj8nLCAi6K2m5ZGKIiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGNsZWFyU2F2ZUZpbGUoKTsKICAgICAgfSkudGhlbigodmFsdWVzKSA9PiB7CiAgICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICAgICAgdGhpcy5tc2dTdWNjZXNzKHZhbHVlcy5tc2cpOwogICAgICB9KQogICAgfSwKICAgIC8qKiDlrozmiJDmjInpkq4gKi8KICAgIHN1Ym1pdEZvcm06IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5nZXRMaXN0KCk7CiAgICAgIHRoaXMub3BlbiA9IGZhbHNlOwogICAgICB0aGlzLiRyZWZzLnNhdmVGaWxlLmZpbGVMaXN0ID0gW10KICAgIH0sCiAgICBDb3B5RmlsZVVybCh2YWx1ZXMpewogICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW5wdXQpOwogICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgdmFsdWVzKTsKICAgICAgaW5wdXQuc2VsZWN0KCk7CiAgICAgIGlmIChkb2N1bWVudC5leGVjQ29tbWFuZCgnY29weScpKSB7CiAgICAgICAgZG9jdW1lbnQuZXhlY0NvbW1hbmQoJ2NvcHknKTsKICAgICAgICB0aGlzLm1zZ1N1Y2Nlc3MoIuWkjeWItuaIkOWKnyIpOwogICAgICB9CiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoaW5wdXQpOwogICAgfQogIH0KCn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuJA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/vadmin/system/savefile","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form :model=\"queryParams\" ref=\"queryForm\" :inline=\"true\" v-show=\"showSearch\" label-width=\"68px\">\n      <el-form-item label=\"文件名称\" prop=\"name\">\n        <el-input\n          v-model=\"queryParams.name\"\n          placeholder=\"请输入文件名称\"\n          clearable\n          size=\"small\"\n          style=\"width: 240px\"\n          @keyup.enter.native=\"handleQuery\"\n        />\n      </el-form-item>\n      <el-form-item label=\"文件类型\" prop=\"type\">\n        <el-input\n          v-model=\"queryParams.type\"\n          placeholder=\"请输入文件类型\"\n          clearable\n          size=\"small\"\n          style=\"width: 240px\"\n          @keyup.enter.native=\"handleQuery\"\n        />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" icon=\"el-icon-search\" size=\"mini\" @click=\"handleQuery\">搜索</el-button>\n        <el-button icon=\"el-icon-refresh\" size=\"mini\" @click=\"resetQuery\">重置</el-button>\n      </el-form-item>\n    </el-form>\n\n    <el-row :gutter=\"10\" class=\"mb8\">\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"primary\"\n          plain\n          icon=\"el-icon-upload\"\n          size=\"mini\"\n          @click=\"handleAdd\"\n          v-hasPermi=\"['system:savefile:post']\"\n        >文件上传\n        </el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"danger\"\n          plain\n          icon=\"el-icon-delete\"\n          size=\"mini\"\n          :disabled=\"multiple\"\n          @click=\"handleDelete\"\n          v-hasPermi=\"['system:savefile:{id}:delete']\"\n        >批量删除\n        </el-button>\n      </el-col>\n      <el-col :span=\"1.5\">\n        <el-button\n          type=\"warning\"\n          plain\n          icon=\"el-icon-download\"\n          size=\"mini\"\n          @click=\"handleClear\"\n          v-hasPermi=\"['system:clearsavefile:post']\"\n        >清理废弃文件\n        </el-button>\n      </el-col>\n      <right-toolbar :showSearch.sync=\"showSearch\" @queryTable=\"getList\"></right-toolbar>\n    </el-row>\n\n    <el-table v-loading=\"loading\" :data=\"fileList\" @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\" width=\"55\" align=\"center\"/>\n      <el-table-column label=\"文件编号\" width=\"90\" align=\"center\" prop=\"id\"/>\n      <el-table-column label=\"文件名称\" width=\"200\" align=\"center\" prop=\"name\" :show-overflow-tooltip=\"true\"/>\n      <el-table-column label=\"文件类型\" width=\"150\" align=\"center\" prop=\"type\"/>\n      <el-table-column label=\"文件大小\" width=\"90\" align=\"center\" prop=\"size\"/>\n      <el-table-column label=\"存储位置\" align=\"center\" prop=\"address\"/>\n      <el-table-column label=\"文件来源\" align=\"center\" prop=\"source\"/>\n      <el-table-column label=\"文件本地地址\" align=\"center\" prop=\"file\" :show-overflow-tooltip=\"true\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-document-copy\"\n            @click=\"CopyFileUrl(scope.row.file)\"\n            v-if=\"scope.row.file\"\n          ></el-button>\n          &nbsp;\n          <span>{{ scope.row.file }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"OSS地址\" align=\"center\" prop=\"oss_url\" :show-overflow-tooltip=\"true\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-document-copy\"\n            @click=\"CopyFileUrl(scope.row.oss_url)\"\n            v-if=\"scope.row.oss_url\"\n          ></el-button>\n          &nbsp;\n          <span>{{ scope.row.oss_url }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column label=\"创建时间\" align=\"center\" prop=\"create_datetime\" width=\"160\">\n        <template slot-scope=\"scope\">\n          <span>{{ parseTime(scope.row.create_datetime) }}</span>\n        </template>\n      </el-table-column>\n      <el-table-column\n        label=\"操作\"\n        align=\"center\"\n        class-name=\"small-padding fixed-width\"\n        width=\"130\"\n        v-if=\"hasPermi(['system:clearsavefile:download:post'])\"\n      >\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-download\"\n            @click=\"handleDownload(scope.row)\"\n            v-hasPermi=\"['system:clearsavefile:download:post']\"\n          >下载\n          </el-button>\n          <el-button\n            size=\"mini\"\n            type=\"text\"\n            icon=\"el-icon-delete\"\n            @click=\"handleDelete(scope.row)\"\n            v-hasPermi=\"['system:savefile:{id}:delete']\"\n          >删除\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <pagination\n      v-show=\"total>0\"\n      :total=\"total\"\n      :page.sync=\"queryParams.pageNum\"\n      :limit.sync=\"queryParams.pageSize\"\n      @pagination=\"getList\"\n    />\n    <!-- 对话框 -->\n    <el-dialog :title=\"title\" :visible.sync=\"open\" width=\"400px\" append-to-body @close=\"submitForm\">\n      <FileUpload ref=\"saveFile\" :file-type=\"['ALL']\" @input=\"submitForm\"></FileUpload>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"submitForm\">完 成</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  import {clearSaveFile, delSaveFile, listSaveFile} from \"@/api/vadmin/system/savefile\";\n  import FileUpload from \"@/components/FileUpload/index\";\n\n  export default {\n    name: \"Savefile\",\n    components: {FileUpload},\n    data() {\n      return {\n        // 遮罩层\n        loading: true,\n        // 显示搜索条件\n        showSearch: true,\n        // 非单个禁用\n        single: true,\n        // 非多个禁用\n        multiple: true,\n        // 弹出层标题\n        title: \"\",\n        // 是否显示弹出层\n        open: false,\n        // 查询参数\n        queryParams: {\n          pageNum: 1,\n          pageSize: 10,\n          name: undefined,\n          type: undefined,\n        },\n        // 总条数\n        total: 0,\n        // 数据列表\n        fileList: [],\n      }\n    },\n    created() {\n      this.getList();\n    },\n    mounted() {\n    },\n    methods: {\n      /** 查询列表 */\n      getList() {\n        this.loading = true;\n        listSaveFile(this.queryParams).then(response => {\n          this.fileList = response.data.results;\n          this.total = response.data.count;\n          this.loading = false;\n        });\n      },\n      /** 搜索按钮操作 */\n      handleQuery() {\n        this.getList();\n      },\n      /** 重置按钮操作 */\n      resetQuery() {\n        this.resetForm(\"queryForm\");\n        this.handleQuery();\n      },\n      /** 上传按钮操作 */\n      handleAdd(row) {\n        this.open = true;\n        this.title = \"上传文件\";\n      },\n      /** 文件下载 **/\n      handleDownload(row) {\n        this.download(row.file_url, row.name)\n      },\n      /** 删除按钮操作 */\n      handleDelete(row) {\n        const userIds = row.id || this.ids;\n        this.$confirm('是否确认删除文件编号为\"' + userIds + '\"的数据项?', \"警告\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function () {\n          return delSaveFile(userIds);\n        }).then(() => {\n          this.getList();\n          this.msgSuccess(\"删除成功\");\n        })\n      },\n      // 多选框选中数据\n      handleSelectionChange(selection) {\n        this.ids = selection.map(item => item.id)\n        this.single = selection.length !== 1\n        this.multiple = !selection.length\n      },\n      /** 清理废弃文件 */\n      handleClear() {\n        this.$confirm('此项操作会把所有数据库中不存在的文件删除，包括OSS中的文件，是否确认要清理废弃文件?', \"警告\", {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\",\n          type: \"warning\"\n        }).then(function () {\n          return clearSaveFile();\n        }).then((values) => {\n          this.getList();\n          this.msgSuccess(values.msg);\n        })\n      },\n      /** 完成按钮 */\n      submitForm: function () {\n        this.getList();\n        this.open = false;\n        this.$refs.saveFile.fileList = []\n      },\n      CopyFileUrl(values){\n        const input = document.createElement('input');\n        document.body.appendChild(input);\n        input.setAttribute('value', values);\n        input.select();\n        if (document.execCommand('copy')) {\n          document.execCommand('copy');\n          this.msgSuccess(\"复制成功\");\n        }\n        document.body.removeChild(input);\n      }\n    }\n\n  }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}