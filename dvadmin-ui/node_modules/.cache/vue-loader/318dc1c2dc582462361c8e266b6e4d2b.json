{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\src\\views\\vadmin\\system\\message\\Mymessage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\src\\views\\vadmin\\system\\message\\Mymessage.vue","mtime":1620833396858},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin\\dvadmin-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7dXBkYXRlSXNSZWFkLCB1c2VyTWVzc2FnZX0gZnJvbSAiQC9hcGkvdmFkbWluL3N5c3RlbS9tZXNzYWdlIjsKaW1wb3J0IHN0b3JlIGZyb20gIkAvc3RvcmUiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNeW1lc3NhZ2UiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDmn6Xor6LpgJrnn6UKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgfSwKICAgICAgbWVzc2FnZUxpc3Q6IFtdLAogICAgICAvLyDlt7Lor7vpgJrnn6UKICAgICAgY291bnRSZWFkZWQ6IDAsCiAgICAgIG1lc3NhZ2VSZWFkZWRMaXN0OiBbXSwKICAgICAgLy8g5pyq6K+75raI5oGv5YiX6KGoCiAgICAgIG1lc3NhZ2VVbnJlYWRMaXN0OiBbXSwKICAgICAgY291bnRVbnJlYWQ6IDAsCiAgICAgIGJhZGdlVHlwZTogJ2RhbmdlcicsCiAgICAgIC8vIOmAieS4reafpeivouWQjueahOivpue7huS/oeaBrwogICAgICBzaG93aW5nTXNnSXRlbToge30KICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCkKCiAgfSwKICBtZXRob2RzOiB7CiAgICAvKiog5p+l6K+i6YCa55+l5YiX6KGoICovCiAgICBnZXRMaXN0KCkgewogICAgICAvLyDlt7Lor7vpgJrnn6XliJfooagKICAgICAgdXNlck1lc3NhZ2UodGhpcy5hZGREYXRlUmFuZ2Uoey4uLnRoaXMucXVlcnlQYXJhbXMsIGlzX3JlYWQ6ICdUcnVlJ30pKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIHRoaXMubWVzc2FnZVJlYWRlZExpc3QgPSByZXNwb25zZS5kYXRhLnJlc3VsdHM7CiAgICAgICAgICB0aGlzLmNvdW50UmVhZGVkID0gcmVzcG9uc2UuZGF0YS5jb3VudDsKCiAgICAgICAgfQogICAgICApOwogICAgICAvLyDmnKror7vpgJrnn6XliJfooagKICAgICAgdXNlck1lc3NhZ2UodGhpcy5hZGREYXRlUmFuZ2Uoey4uLnRoaXMucXVlcnlQYXJhbXMsIGlzX3JlYWQ6ICdGYWxzZSd9KSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICB0aGlzLm1lc3NhZ2VVbnJlYWRMaXN0ID0gcmVzcG9uc2UuZGF0YS5yZXN1bHRzOwogICAgICAgICAgdGhpcy5jb3VudFVucmVhZCA9IHJlc3BvbnNlLmRhdGEuY291bnQ7CiAgICAgICAgICB0aGlzLm1lc3NhZ2VMaXN0ID0gdGhpcy5tZXNzYWdlVW5yZWFkTGlzdAogICAgICAgIH0KICAgICAgKTsKICAgIH0sCiAgICBoYW5kbGVTZWxlY3Qoa2V5LCBrZXlQYXRoKSB7CiAgICAgIHRoaXMubWVzc2FnZUxpc3QgPSBrZXlbMF0gPT09ICIxIiA/IHRoaXMubWVzc2FnZVVucmVhZExpc3QgOiB0aGlzLm1lc3NhZ2VSZWFkZWRMaXN0CiAgICAgIHRoaXMuYmFkZ2VUeXBlID0ga2V5WzBdID09PSAiMSIgPyAnZGFuZ2VyJyA6ICdpbmZvJwogICAgfSwKICAgIC8vIOmAmuefpeWIl+ihqOa/gOa0u+WQjgogICAgaGFuZGxlTGlzdFNlbGVjdChrZXksIGtleVBhdGgpIHsKICAgICAgdGhpcy5zaG93aW5nTXNnSXRlbSA9IHRoaXMubWVzc2FnZUxpc3Rba2V5WzBdXQogICAgICAvLyDkv67mlLnpgJrnn6Xmn6Xor6LnirbmgIEKICAgICAgaWYgKHRoaXMuYmFkZ2VUeXBlID09PSAiZGFuZ2VyIikgewogICAgICAgIHVwZGF0ZUlzUmVhZCh0aGlzLnNob3dpbmdNc2dJdGVtKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIGlmKHJlc3BvbnNlLmNvZGUgPT09IDIwMCl7CiAgICAgICAgICAgIHN0b3JlLmNvbW1pdCgnU0VUX1VOUkVBRF9NU0dfQ09VTlQnLCBzdG9yZS5nZXR0ZXJzLnVucmVhZF9tc2dfY291bnQgLSAxKTsKICAgICAgICAgICAgdGhpcy5vcGVuID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Mymessage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Mymessage.vue","sourceRoot":"src/views/vadmin/system/message","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-card shadow=\"never\">\n      <div class=\"message-page-con message-category-con\">\n        <el-menu\n          default-active=\"1\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleSelect\">\n          <el-menu-item index=\"1\">\n            <template slot=\"title\">\n              <span class=\"category-title\">未读消息</span>\n              <el-badge style=\"margin-bottom: 3px\" :value=\"countUnread\" :hidden=\"countUnread===0\"></el-badge>\n            </template>\n          </el-menu-item>\n          <el-menu-item index=\"2\">\n            <span class=\"category-title\">已读消息</span>\n            <el-badge style=\"margin-bottom: 3px\" type=\"info\" :value=\"countReaded\"></el-badge>\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-list-con\">\n        <el-menu\n          default-active=\"2\"\n          class=\"el-menu-vertical-demo\"\n          @select=\"handleListSelect\">\n          <el-menu-item v-for=\"(item,index) in messageList\" :key=\"index\" :index=\"index.toString()\">\n            <template slot=\"title\">\n              <div style=\"line-height: 10px!important;height: 20px;\">\n                <p class=\"msg-title\">{{ item.title }}</p>\n                <el-badge is-dot class=\"item\" :type=\"badgeType\"></el-badge>\n                {{item.create_datetime}}\n\n              </div>\n            </template>\n          </el-menu-item>\n        </el-menu>\n      </div>\n      <div class=\"message-page-con message-view-con\">\n        <div class=\"message-view-header\">\n          <h2 class=\"message-view-title\">{{ showingMsgItem.title }}</h2>\n          <time class=\"message-view-time\">{{ showingMsgItem.create_datetime }}</time>\n        </div>\n        <div v-html=\"showingMsgItem.content\"></div>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\n  import {updateIsRead, userMessage} from \"@/api/vadmin/system/message\";\n  import store from \"@/store\";\n\n  export default {\n    name: \"Mymessage\",\n    data() {\n      return {\n        // 查询通知\n        queryParams: {\n          pageNum: 1,\n          pageSize: 10,\n        },\n        messageList: [],\n        // 已读通知\n        countReaded: 0,\n        messageReadedList: [],\n        // 未读消息列表\n        messageUnreadList: [],\n        countUnread: 0,\n        badgeType: 'danger',\n        // 选中查询后的详细信息\n        showingMsgItem: {}\n      };\n    },\n    created() {\n      this.getList()\n\n    },\n    methods: {\n      /** 查询通知列表 */\n      getList() {\n        // 已读通知列表\n        userMessage(this.addDateRange({...this.queryParams, is_read: 'True'})).then(response => {\n            this.messageReadedList = response.data.results;\n            this.countReaded = response.data.count;\n\n          }\n        );\n        // 未读通知列表\n        userMessage(this.addDateRange({...this.queryParams, is_read: 'False'})).then(response => {\n            this.messageUnreadList = response.data.results;\n            this.countUnread = response.data.count;\n            this.messageList = this.messageUnreadList\n          }\n        );\n      },\n      handleSelect(key, keyPath) {\n        this.messageList = key[0] === \"1\" ? this.messageUnreadList : this.messageReadedList\n        this.badgeType = key[0] === \"1\" ? 'danger' : 'info'\n      },\n      // 通知列表激活后\n      handleListSelect(key, keyPath) {\n        this.showingMsgItem = this.messageList[key[0]]\n        // 修改通知查询状态\n        if (this.badgeType === \"danger\") {\n          updateIsRead(this.showingMsgItem).then(response => {\n            if(response.code === 200){\n              store.commit('SET_UNREAD_MSG_COUNT', store.getters.unread_msg_count - 1);\n              this.open = false;\n              this.getList();\n            }\n          });\n        }\n      }\n    }\n  };\n</script>\n<style scoped>\n  .app-container {\n    background-color: #f5f7f9;\n  }\n\n  .message-category-con {\n    border-right: 1px solid #e6e6e6;\n    width: 200px;\n  }\n\n  .message-page-con {\n    height: calc(100vh - 176px);\n    display: inline-block;\n    vertical-align: top;\n    position: relative;\n  }\n\n  .category-title {\n    display: inline-block;\n    width: 65px;\n  }\n\n\n  .message-list-con {\n    border-right: 1px solid #e6e6e6;\n    width: 230px;\n  }\n\n  .msg-title {\n    word-break: break-all;\n    white-space: normal;\n    line-height: 15px;\n    color: rgb(170, 169, 169);\n  }\n\n  .message-list-con .el-menu-item {\n    height: 80px;\n    padding-top: 5px;\n  }\n\n  .item {\n    margin-right: 10px;\n    margin-bottom: 5px;\n  }\n\n  .message-view-con {\n    position: absolute;\n    left: 486px;\n    top: 16px;\n    right: 16px;\n    bottom: 16px;\n    overflow: auto;\n    padding: 12px 20px 0;\n\n  }\n\n  .message-view-header {\n    margin-bottom: 20px;\n\n  }\n\n  .message-view-title {\n    display: inline-block;\n  }\n\n  .message-view-time {\n    margin-left: 20px;\n  }\n</style>\n"]}]}